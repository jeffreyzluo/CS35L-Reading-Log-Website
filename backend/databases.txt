CREATE TABLE users (
    username      VARCHAR(50) PRIMARY KEY,
    email         VARCHAR(255) UNIQUE NOT NULL,
    password_hash TEXT NOT NULL,
    date_joined   TIMESTAMP NOT NULL DEFAULT NOW(),
    description   TEXT
);

CREATE TABLE user_books (
    username    VARCHAR(50) REFERENCES users(username) ON DELETE CASCADE ON UPDATE CASCADE,   
    book_id     TEXT,
    rating      INT,
    review      TEXT,
    status      TEXT,
    added_at    TIMESTAMP DEFAULT NOW(),
    PRIMARY KEY (username, book_id)
);

CREATE TABLE user_friends (
    user_username    VARCHAR(50) REFERENCES users(username) ON DELETE CASCADE ON UPDATE CASCADE,
    friend_username  VARCHAR(50) REFERENCES users(username) ON DELETE CASCADE ON UPDATE CASCADE,
    PRIMARY KEY (user_username, friend_username)
);
